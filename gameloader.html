<!-- gameloader.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Game Loader</title>
  <link rel="stylesheet" href="css/games.css" />
</head>
<body>

  <div class="container loader-page">
    <!-- Loader + Footer Column -->
    <div class="loader-wrapper">
      <div id="gameContainer">
        <!-- start screen injected by script -->
      </div>
      <footer class="loader-footer">
        <div class="branding">
          <img src="assets/nexora-logo.png" alt="Nexora Logo" />
          <span>Nexora</span>
        </div>
        <button id="fullscreenBtn" class="fullscreen-btn">
          Full Screen
        </button>
      </footer>
    </div>

    <!-- Recommended Games Column -->
    <aside class="recommended">
      <h3>Recommended</h3>
      <div class="recommend-grid" id="recommendGrid">
        <!-- rec cards injected by script -->
      </div>
    </aside>
  </div>

  <script>
    const games = [
      { title: "1v1.Lol", file: "cl1v1lol.html", thumbnail: "assets/thumbnails/1v1lol.png" },
      { title: "Sky Riders", file: "sky-riders.html", thumbnail: "assets/thumbnails/sky-riders.png" },
      { title: "Pong", file: "pong.html", thumbnail: "assets/thumbnails/pong.png" },
      { title: "Bloxd.io", file: "bloxd.html", thumbnail: "assets/thumbnails/bloxd.png" }
      // add more games here
    ];

    // pick current game from URL
    const params = new URLSearchParams(window.location.search);
    const currentFile = params.get("game");
    const currentGame = games.find(g => g.file === currentFile);

    const gameContainer = document.getElementById("gameContainer");
    const recommendGrid = document.getElementById("recommendGrid");

    function showStartScreen() {
      gameContainer.innerHTML = "";
      const start = document.createElement("div");
      start.className = "loader-start";
      start.innerHTML = `
        <img src="${currentGame.thumbnail}" alt="${currentGame.title}" />
        <h2 class="game-title">${currentGame.title}</h2>
        <button id="playBtn" class="play-btn">Play Now</button>
      `;
      gameContainer.appendChild(start);

      document.getElementById("playBtn").onclick = () => {
        const iframe = document.createElement("iframe");
        iframe.src = currentGame.file;
        iframe.allowFullscreen = true;
        iframe.frameBorder = 0;
        iframe.className = "game-iframe";
        gameContainer.innerHTML = "";
        gameContainer.appendChild(iframe);
      };
    }

    function renderRecommended() {
      const others = games
        .filter(g => g.file !== currentFile)
        .sort(() => 0.5 - Math.random())
        .slice(0, 4);
      recommendGrid.innerHTML = "";
      others.forEach(g => {
        const card = document.createElement("div");
        card.className = "rec-card";
        card.onclick = () => {
          window.location.href = `gameloader.html?game=${encodeURIComponent(g.file)}`;
        };
        card.innerHTML = `
          <img src="${g.thumbnail}" alt="${g.title}">
          <div class="rec-title">${g.title}</div>
        `;
        recommendGrid.appendChild(card);
      });
    }

    // fullscreen logic
    document.getElementById("fullscreenBtn").onclick = () => {
      const el = gameContainer.querySelector(".game-iframe") || gameContainer;
      if (el.requestFullscreen) el.requestFullscreen();
      else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
    };

    if (currentGame) {
      showStartScreen();
      renderRecommended();
    } else {
      gameContainer.textContent = "Game not found.";
    }
  </script>

</body>
</html>
